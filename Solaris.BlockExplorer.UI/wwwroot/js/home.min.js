function loadMarketData(n){$.post(_endpoints.marketData,function(t){$("#marketData").html(t);n&&n()})}function connectFeed(){const n=(new window.signalR.HubConnectionBuilder).withUrl("/wsbn").configureLogging(window.signalR.LogLevel.Error).build();n.on("wsbn",n=>{var t=$("#lastBlockHeight");parseInt(t.html())<n.height&&t.html(n.height);highLight(t);$.post(_endpoints.block,{height:n.height},function(t){const i=$.parseHTML(t),r=$(`#${n.height}`);if(r.length)r.replaceWith(i);else{const t=$("#rows .row").first();var u=parseInt(t.prop("id"));u<n.height&&$("#rows").prepend(i)}highLight(i)})});startFeed(n)}function setMarketDataInterval(){setInterval(function(){loadMarketData()},3e4)}function startFeed(n){n.onclose(()=>{console.log("Websocket closed, restarting..."),setTimeout(()=>startFeed(n),5e3)});n.connection.connectionState===2&&n.start().catch(t=>{console.log(`Problem starting websocket connection ${t.toString()}`),setTimeout(()=>this.Start(n),5e3)}).then(()=>{console.log("Websocket started")})}function highLight(n){$(n).addClass("text-white");$(n).finish().effect("highlight",{color:"#00AE52"},1e3,function(){$(n).removeClass("text-white")})}$(document).ready(function(){loadMarketData(function(){setMarketDataInterval()});connectFeed()});